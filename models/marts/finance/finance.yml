models:
  - name: fct_orders
    columns:
      - name: order_id
        data_tests:
          # - not_null
          - unique
          - not_null_or_test:
              arguments:
                column_name: order_id
                column_id: customer_id
      - name: customer_id
        data_tests:
          - not_null
      - name: amount
        description: Dollars spent per order
        data_tests: 
          - dbt_expectations.expect_column_values_to_be_between: 
          # this will perform what the dbt_utils.expression-is-true test does!
              arguments:
                  min_value: 0
                  max_value: 9999
                  row_condition: "order_id is not null" 
                  strictly: false
          - dbt_expectations.expect_column_mean_to_be_between: 
          # this will perform what our singular and generic tests do!
              arguments:
                  min_value: 1
                  group_by: [customer_id] 
                  row_condition: "order_id is not null" # (Optional)
                  strictly: false
          - greater_than_number:
              arguments:
                  column_name: amount
                  value: 10
              config:
                  severity: error
                  error_if: '>100'
                  warn_if: '>50'
        # or using built in dbt_utils
          # - dbt_utils.expression_is_true:
          #     arguments:
          #       expression: "<=10"